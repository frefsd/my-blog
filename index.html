<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>æˆ‘çš„åšå®¢ - é¦–é¡µ</title>
		<link rel="stylesheet" href="css/style.css" />
		<style>
			/* ä¸»ä½“æ ·å¼ */
			body {
				font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
				background-color: #f5f7fa;
				color: #333;
				margin: 0;
				padding: 0;
			}

			.container {
				max-width: 800px;
				margin: 2rem auto;
				padding: 0 1rem;
			}

			/* æœç´¢æ¡†æ ·å¼ */
			.search-box {
				display: flex;
				align-items: center;
				justify-content: center;
				margin-bottom: 1.5rem;
				position: relative;
				width: 100%;
			}

			.search-box input {
				width: 100%;
				padding: 0.8rem 1.2rem;
				border: 1px solid #ddd;
				border-radius: 30px;
				font-size: 1rem;
				outline: none;
				transition: box-shadow 0.3s;
			}

			.search-box input:focus {
				box-shadow: 0 0 0 2px #4a6fa5;
				border-color: #4a6fa5;
			}

			.search-box svg {
				position: absolute;
				left: 1rem;
				fill: #999;
				width: 16px;
				height: 16px;
			}

			/* ä¸‹æ‹‰æ¡†æ ·å¼ */
			.filter-select {
				display: block;
				width: 100%;
				padding: 0.7rem;
				border: 1px solid #ddd;
				border-radius: 8px;
				font-size: 1rem;
				margin-bottom: 1.5rem;
				background-color: white;
				cursor: pointer;
			}

			/* æ–‡ç« åˆ—è¡¨ */
			.post-item {
				margin-bottom: 2rem;
				padding: 1rem;
				background: white;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
				transition: transform 0.3s, box-shadow 0.3s;
			}

			.post-item:hover {
				transform: translateY(-2px);
				box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
			}

			.post-item h2 {
				margin: 0 0 0.5rem 0;
				color: #4a6fa5;
				font-size: 1.4rem;
			}

			.post-item .date {
				color: #666;
				font-size: 0.9rem;
				margin-bottom: 0.5rem;
			}

			.post-item .excerpt {
				color: #555;
				line-height: 1.6;
			}

			.post-item .category-tag {
				display: inline-block;
				padding: 0.2rem 0.6rem;
				background: #4a6fa5;
				color: white;
				border-radius: 12px;
				font-size: 0.8rem;
				margin-top: 0.5rem;
			}
			
			/* æ•°å­—é›¨æ»´Canvasæ ·å¼ */
			        #rainCanvas {
			            position: fixed;
			            top: 0;
			            left: 0;
			            width: 100%;
			            height: 100%;
			            z-index: -1;
			            pointer-events: none;
			        }

			/*æš—é»‘æ¨¡å¼æ ·å¼ï¼ˆç‹¬ç«‹å†™åœ¨æœ€å¤–å±‚ï¼‰*/
			.dark-mode {
				background-color: #1a1a1a !important;
				color: #e0e0e0 !important;
			}

			.dark-mode .container,
			.dark-mode .post-item,
			.dark-mode header,
			.dark-mode footer {
				background-color: #242424 !important;
				color: #e0e0e0 !important;
				border-color: #444 !important;
			}

			.dark-mode .post-item a {
				color: #8ba7ef !important;
			}

			.dark-mode .search-box input,
			.dark-mode .filter-select {
				background-color: #333 !important;
				color: #e0e0e0 !important;
				border-color: #555 !important;
			}

			.dark-mode .search-box svg {
				fill: #aaa !important;
			}

			.dark-mode .category-tag {
				background-color: #6b8ed6 !important;
			}

			.dark-mode footer {
				color: #aaa !important;
			}

			.dark-mode nav a {
				color: #aaa !important;
			}

			.dark-mode .no-results {
				color: #999 !important;
			}
		</style>
	</head>

	<script>
		// ===== æš—é»‘æ¨¡å¼åˆ‡æ¢åŠŸèƒ½ =====
		const DARK_MODE_KEY = 'dark-mode-preference';

		// åˆ›å»ºæš—é»‘æ¨¡å¼æŒ‰é’®å’Œæ ·å¼
		function initDarkMode() {
			// æ£€æŸ¥ç”¨æˆ·åå¥½
			const isDarkMode = localStorage.getItem(DARK_MODE_KEY) === 'true';

			// è®¾ç½® body ç±»
			if (isDarkMode) {
				document.body.classList.add('dark-mode');
			}

			// åˆ›å»ºæŒ‰é’®
			const toggleButton = document.createElement('button');
			toggleButton.id = 'dark-mode-toggle';
			toggleButton.innerHTML = isDarkMode ?
				'ğŸŒ' // ç™½å¤©
				:
				'ğŸŒ™'; // æš—é»‘
			toggleButton.title = isDarkMode ? 'åˆ‡æ¢åˆ°ç™½å¤©æ¨¡å¼' : 'åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼';
			toggleButton.style.cssText = `
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: none;
      background: ${isDarkMode ? '#f0f0f0' : '#333'};
      color: ${isDarkMode ? '#333' : '#f0f0f0'};
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 9999;
      transition: all 0.3s ease;
    `;
			toggleButton.onclick = function() {
				const isNowDark = !document.body.classList.contains('dark-mode');
				document.body.classList.toggle('dark-mode', isNowDark);
				localStorage.setItem(DARK_MODE_KEY, isNowDark);
				toggleButton.innerHTML = isNowDark ? 'ğŸŒ' : 'ğŸŒ™';
				toggleButton.style.background = isNowDark ? '#f0f0f0' : '#333';
				toggleButton.style.color = isNowDark ? '#333' : '#f0f0f0';
				toggleButton.title = isNowDark ? 'åˆ‡æ¢åˆ°ç™½å¤©æ¨¡å¼' : 'åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼';
			};

			document.body.appendChild(toggleButton);
		}
		
		// æ•°å­—é›¨æ»´æ•ˆæœä»£ç 
		document.addEventListener('DOMContentLoaded', function() {
		  const canvas = document.createElement('canvas');
		  canvas.id = 'rainCanvas';
		  document.body.appendChild(canvas);
		  
		  const ctx = canvas.getContext('2d');
		  canvas.width = window.innerWidth;
		  canvas.height = window.innerHeight;
		  
		  const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
		  let particles = [];
		  
		  class Particle {
		    constructor() {
		      this.reset();
		    }
		    
		    reset() {
		      this.x = Math.random() * canvas.width;
		      this.y = Math.random() * -canvas.height;
		      this.speedY = Math.random() * 5 + 5;
		      this.speedX = (Math.random() - 0.5) * 0.5;
		      this.size = Math.random() * 20 + 15;
		      this.opacity = Math.random() * 0.5 + 0.5;
		      this.char = chars[Math.floor(Math.random() * chars.length)];
		      this.gravity = 0.1;
		      this.windResistance = 0.98;
		      this.changeInterval = Math.floor(Math.random() * 10) + 5;
		      this.frameCount = 0;
		    }
		    
		    update() {
		      this.speedY += this.gravity;
		      this.speedX *= this.windResistance;
		      
		      this.x += this.speedX;
		      this.y += this.speedY;
		      
		      this.frameCount++;
		      if (this.frameCount >= this.changeInterval) {
		        this.char = chars[Math.floor(Math.random() * chars.length)];
		        this.frameCount = 0;
		      }
		      
		      if (this.y > canvas.height || this.x < 0 || this.x > canvas.width) {
		        this.reset();
		        this.y = Math.random() * -50;
		      }
		    }
		    
		    draw() {
		      ctx.font = `${this.size}px 'Courier New', monospace`;
		      ctx.fillStyle = `rgba(0, 255, 0, ${this.opacity})`;
		      ctx.fillText(this.char, this.x, this.y);
		    }
		  }
		  
		  function initParticles(count) {
		    particles = [];
		    for (let i = 0; i < count; i++) {
		      particles.push(new Particle());
		    }
		  }
		  
		  function animate() {
		    ctx.fillStyle = 'rgba(15, 12, 41, 0.1)';
		    ctx.fillRect(0, 0, canvas.width, canvas.height);
		    
		    particles.forEach(particle => {
		      particle.update();
		      particle.draw();
		    });
		    
		    requestAnimationFrame(animate);
		  }
		  
		  window.addEventListener('resize', function() {
		    canvas.width = window.innerWidth;
		    canvas.height = window.innerHeight;
		  });
		  
		  // åˆå§‹åŒ–å¹¶å¼€å§‹åŠ¨ç”»
		  initParticles(80); // å‡å°‘ç²’å­æ•°é‡ä»¥æé«˜æ€§èƒ½
		  animate();
		});
		
		// åˆå§‹åŒ–
		document.addEventListener('DOMContentLoaded', initDarkMode);
	</script>

	<body>
		<header
			style="position: relative; text-align: center; padding: 4rem 0; background-image: url('images/az.jpg'); background-size: cover; background-position: center; color: white;">
			<!-- é®ç½©å±‚ -->
			<div
				style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.0);">
			</div>

			<h1 style="
      font-size: 2.8rem;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      z-index: 1;
      position: relative;
    ">
				<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="currentColor">
					<path />
				</svg>
			</h1>

			<nav style="margin-top: 1rem; z-index: 1; position: relative;">
				<a href="index.html" style="margin: 0 1rem; color: white; text-decoration: none;">é¦–é¡µ</a>
				<a href="about.html" style="margin: 0 1rem; color: white; text-decoration: none;">å…³äº</a>
				<a href="growup.html" style="margin: 0 1rem; color: white; text-decoration: none;">æˆé•¿</a>
			</nav>
		</header>

		<main id="home-container" class="container">
			<p>æ­£åœ¨åŠ è½½æ–‡ç« ...</p>
		</main>

		<footer style="text-align: center; padding: 1.5rem 0; color: #666; font-size: 0.9rem;">
			&copy; å’¸é±¼ç¿»èº«
		</footer>

		<script>
			document.addEventListener('DOMContentLoaded', function() {
				const container = document.getElementById('home-container');
				let currentCategory = ''; // å½“å‰é€‰ä¸­çš„åˆ†ç±»
				let searchKeyword = ''; // å½“å‰æœç´¢è¯

				fetch('posts.json')
					.then(res => res.json())
					.then(posts => {
						if (!posts || posts.length === 0) {
							container.innerHTML = '<p>æš‚æ— æ–‡ç« ã€‚</p>';
							return;
						}

						// æå–æ‰€æœ‰å”¯ä¸€åˆ†ç±»
						const categories = ['å…¨éƒ¨'];
						const categorySet = new Set(posts.map(p => p.category));
						categories.push(...Array.from(categorySet).sort());

						// æ¸²æŸ“å‡½æ•°
						function renderPosts() {
							let filtered = posts;

							if (currentCategory && currentCategory !== 'å…¨éƒ¨') {
								filtered = filtered.filter(p => p.category === currentCategory);
							}

							if (searchKeyword) {
								const keyword = searchKeyword.toLowerCase();
								filtered = filtered.filter(p =>
									p.title.toLowerCase().includes(keyword) ||
									(p.excerpt && p.excerpt.toLowerCase().includes(keyword))
								);
							}

							// ç”Ÿæˆæ–‡ç«  HTML
							const postList = filtered.length > 0 ?
								filtered.map((post, index) => {
									const postId = posts.indexOf(post);
									return `
                    <article class="post-item">
                      <h2><a href="post.html?id=${postId}" style="color: #4a6fa5; text-decoration: none;">${post.title}</a></h2>
                      <p class="date">${post.date}</p>
                      <p class="excerpt">${post.excerpt || 'æš‚æ— æ‘˜è¦'}</p>
                      <span class="category-tag">${post.category}</span>
                    </article>
                  `;
								}).join('') :
								`<div class="no-results">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æ–‡ç« ã€‚</div>`;

							container.innerHTML = `
              <div>
                
                <!-- æœç´¢æ¡† -->
                <div class="search-box">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg>
                  <input type="text" id="search-input" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." />
                </div>

                <!-- åˆ†ç±»ä¸‹æ‹‰æ¡† -->
                <select class="filter-select" id="category-filter">
                  ${categories.map(cat => `<option value="${cat}" ${cat === currentCategory ? 'selected' : ''}>${cat}</option>`).join('')}
                </select>

                <!-- æ–‡ç« åˆ—è¡¨ -->
                <div id="posts-list">${postList}</div>
              </div>
            `;

							// ç»‘å®šäº‹ä»¶
							bindEvents();
						}

						// ç»‘å®šäº‹ä»¶ç›‘å¬
						function bindEvents() {
							const searchInput = document.getElementById('search-input');
							const categoryFilter = document.getElementById('category-filter');

							// æœç´¢è¾“å…¥
							searchInput.addEventListener('input', (e) => {
								searchKeyword = e.target.value.trim();
								renderPosts();
							});

							// åˆ†ç±»ä¸‹æ‹‰æ¡†å˜åŒ–
							categoryFilter.addEventListener('change', () => {
								currentCategory = categoryFilter.value;
								renderPosts();
							});
						}

						// åˆå§‹æ¸²æŸ“
						renderPosts();
					})
					.catch(err => {
						container.innerHTML = `<p style="color:red;">åŠ è½½å¤±è´¥: ${err.message}</p>`;
					});
			});
		</script>
	</body>
</html>